@using System.Text.RegularExpressions

@model blogapp.Models.BlogPost

<div class="col-md-4 mb-4">
    <div class="card shadow-sm h-100">
        @if (!string.IsNullOrEmpty(Model.ImagePath) || !string.IsNullOrEmpty(Model.VideoPath))
        {
            @if (!string.IsNullOrEmpty(Model.VideoPath))
            {
                <div class="card-img-top" style="height: 200px; position: relative; overflow: hidden;">
                    <video controls style="width: 100%; height: 100%; object-fit: cover;">
                        <source src="@Model.VideoPath" type="video/@Model.VideoPath.Split('.').Last()">
                        Your browser does not support the video tag.
                    </video>
                    <div style="position: absolute; top: 10px; right: 10px; background: rgba(0, 0, 0, 0.7); color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: 500;">
                        <i class="fas fa-play"></i> Video
                    </div>
                </div>
            }
            else if (!string.IsNullOrEmpty(Model.ImagePath))
            {
                <img src="@Model.ImagePath" class="card-img-top" alt="@Model.Title" style="height: 200px; object-fit: cover;" />
            }
        }

        <div class="card-body d-flex flex-column">
            <h5 class="card-title">@Model.Title</h5>
            <p class="card-text text-muted">@Model.CreatedAt.ToString("dd MMM yyyy")</p>

            @{
                var plainText = Regex.Replace(Model.Content ?? "", "<.*?>", ""); // remove HTML tags
                var preview = plainText.Length > 100 ? plainText.Substring(0, 100) + "..." : plainText;
            }
            <p class="card-text">@preview</p>

            <a href="/BlogPost/Details/@Model.Id" class="btn btn-outline-primary mt-auto">Read More</a>
        </div>
    </div>
</div>
